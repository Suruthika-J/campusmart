{% extends 'market/base.html' %}

{% block content %}
<h2>Welcome, {{ user.username }}!</h2>

<h2>Search Items</h2>
<form method="GET">
    {{ form.as_p }}
    <button type="submit">Search</button>
</form>

<hr>

{% for item in items %}
    <div style="border:1px solid #ccc; padding:10px; margin-bottom:10px;">
        <h3>{{ item.title }}</h3>
        <p>{{ item.description }}</p>
        <p>Category: {{ item.category }}</p>
        <p>Price: â‚¹{{ item.price }}</p>
        {% if item.image %}
            <img src="{{ item.image.url }}" width="150" alt="{{ item.title }}">
        {% endif %}

        {% if user.is_authenticated %}
            <form method="post" action="{% url 'market:buy_item' item.id %}">
                {% csrf_token %}
                <button type="submit">Buy</button>
            </form>
        {% else %}
            <a href="{% url 'login' %}">Login to Buy</a>
        {% endif %}
    </div>
{% empty %}
    <p>No items found.</p>
{% endfor %}

{% endblock %}
